<!doctype html>
<html lang="ja">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>org-roam-ui</title>
		<script type="module" src="./src/app.ts"></script>
	</head>
	<body x-data="app()" x-init="init()">
		<!-- グラフ領域 -->
		<div id="graph" x-ref="graph"></div>

		<!-- 左 Offcanvas (Filter) -->
		<div
			class="offcanvas offcanvas-start"
			tabindex="-1"
			id="offcanvasFilter"
			aria-labelledby="offcanvasFilterLabel"
		>
			<div class="offcanvas-header">
				<h6 class="offcanvas-title ps-5" id="offcanvasFilterLabel">
					<i class="bi bi-funnel-fill"></i>Filter
				</h6>
				<button
					type="button"
					class="btn-close btn-close-white"
					data-bs-dismiss="offcanvas"
					aria-label="Close"
				></button>
			</div>
			<div class="offcanvas-body">
				<!-- タグフィルター（Bootstrap Collapse） -->
				<button
					class="btn btn-sm btn-link d-flex align-items-center"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#tagFilters"
					aria-expanded="true"
					aria-controls="tagFilters"
				>
					<i class="bi bi-caret-down-fill me-1"></i>
					Tag Filters
				</button>
				<div class="collapse show mt-2" id="tagFilters">
					<!-- タグチェックボックス -->
				</div>
			</div>
		</div>

		<!-- 左パネル開閉ボタン -->
		<button
			type="button"
			class="btn btn-primary position-fixed"
			style="top: 1rem; left: 1rem; z-index: 1050;"
			data-bs-toggle="offcanvas"
			data-bs-target="#offcanvasFilter"
			aria-controls="offcanvasFilter"
		>
			<i class="bi bi-funnel"></i>
		</button>

		<!-- 右 Offcanvas (Detail) -->
		<div
			class="offcanvas offcanvas-end"
			tabindex="-1"
			id="offcanvasDetails"
			aria-labelledby="offcanvasDetailsLabel"
		>
			<div class="offcanvas-header">
				<h6 class="offcanvas-title pt-2" id="offcanvasDetailsLabel">
					<i class="bi bi-file-earmark-text"></i>
					<span x-text="selected.title"></span>
				</h6>
				<button
					type="button"
					class="btn-close btn-close-white"
					data-bs-dismiss="offcanvas"
					aria-label="Close"
				></button>
			</div>
			<div class="offcanvas-body">
				<div x-html="selected.html"></div>
				<div x-show="selected.backlinks?.length" class="mt-3">
					<h6>
						<i class="bi bi-link-45deg"></i>Backlinks
					</h6>
					<ul class="list-unstyled">
						<template x-for="b in selected.backlinks" :key="b.source">
							<li>
								<button class="btn btn-sm btn-link p-0" @click="open(b.source)">
									<i class="bi bi-chevron-right"></i>
									<span x-text="b.title"></span>
								</button>
							</li>
						</template>
					</ul>
				</div>
			</div>
		</div>

		<!-- 右パネル開閉ボタン -->
		<button
			type="button"
			class="btn btn-primary position-fixed"
			style="top: 1rem; right: 1rem; z-index: 1050;"
			data-bs-toggle="offcanvas"
			data-bs-target="#offcanvasDetails"
			aria-controls="offcanvasDetails"
		>
			<i class="bi bi-chevron-left"></i>
		</button>
	</body>
</html>
